<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Durga Puja Batch ID Generator</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@700&family=Roboto&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Roboto", sans-serif;
        margin: 20px;
        background: #fff0f5;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      h2 {
        color: #c0392b;
        margin-bottom: 15px;
      }
      table {
        border-collapse: collapse;
        margin-bottom: 15px;
      }
      table,
      th,
      td {
        border: 1px solid #c0392b;
      }
      th,
      td {
        padding: 5px 10px;
        font-size: 14px;
      }
      input[type="text"],
      input[type="file"] {
        width: 120px;
        font-size: 14px;
      }
      .id-card {
        width: 8.6cm;
        height: 5.4cm;
        border-radius: 15px;
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
        background: linear-gradient(135deg, #fddede, #f9c5c5);
        padding: 12px;
        box-sizing: border-box;
        position: relative;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        margin-bottom: 20px;
        color: #333;
        font-size: 14px;
        overflow: hidden;
      }
      .heading {
        text-align: center;
        font-family: "Baloo 2", cursive;
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 8px;
        color: #fff;
        background: #c70032;
        padding: 8px 0 8px 0;
        border-radius: 10px 10px 0 0;
        letter-spacing: 1px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        .watermark {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          opacity: 0.13;
          z-index: 0;
          pointer-events: none;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        .watermark img {
          max-width: 80%;
          max-height: 80%;
          object-fit: contain;
        }
      }
      .details {
        display: flex;
        flex-direction: row;
        justify-content: flex-start;
        align-items: flex-start;
        gap: 12px;
      }
      .details img {
        width: 90px;
        height: 110px;
        border-radius: 8px;
        border: 2px solid #8e0e00;
        object-fit: cover;
        background: #fff;
      }
      .info {
        flex-grow: 1;
        padding-left: 8px;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        gap: 4px;
      }
      .info div {
        margin: 2px 0;
      }
      .info span {
        font-weight: bold;
        color: #8e0e00;
      }
      .qr-code {
        position: absolute;
        bottom: 12px;
        right: 12px;
        background: #fff;
        padding: 3px;
        border-radius: 5px;
      }
      button {
        margin: 5px;
        padding: 8px 14px;
        font-size: 14px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        background: #c0392b;
        color: #fff;
        font-weight: bold;
      }
      button:hover {
        background: #a93226;
      }
    </style>
  </head>
  <body>
    <h2>Durga Puja Batch ID Card Generator</h2>

    <table id="memberTable">
      <tr>
        <th>Name</th>
        <th>Role</th>
        <th>Mobile</th>
        <th>Photo</th>
        <th>Action</th>
      </tr>
    </table>

    <button id="addRow">Add Member</button>
    <button id="generateAll">Generate All ID Cards</button>
    <div id="cardsContainer"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <script>
      let currentId = 1;

      // Add a new member row
      document.getElementById("addRow").addEventListener("click", () => {
        const table = document.getElementById("memberTable");
        const row = table.insertRow();
        row.innerHTML = `
    <td><input type="text" placeholder="Name"></td>
    <td><input type="text" placeholder="Role"></td>
    <td><input type="text" placeholder="Mobile"></td>
    <td><input type="file" accept="image/*"></td>
    <td><button class="removeRow">Remove</button></td>
  `;
        row.querySelector(".removeRow").addEventListener("click", () => {
          table.deleteRow(row.rowIndex);
        });
      });

      // Generate all cards
      document.getElementById("generateAll").addEventListener("click", () => {
        const table = document.getElementById("memberTable");
        const container = document.getElementById("cardsContainer");
        container.innerHTML = ""; // Clear previous cards

        for (let i = 1; i < table.rows.length; i++) {
          const row = table.rows[i];
          const name = row.cells[0].querySelector("input").value || "Unknown";
          const role = row.cells[1].querySelector("input").value || "Member";
          const mobile = row.cells[2].querySelector("input").value || "-";
          const photoFile = row.cells[3].querySelector("input").files[0];

          const cardDiv = document.createElement("div");
          cardDiv.className = "id-card";
          cardDiv.innerHTML = `
      <div class="heading">श्री श्री 108 मां वैश्णवी दुर्गा पूजा समिति धरमपुर</div>
      <div class="details">
        <img src="" alt="Photo" id="photo${i}">
        <div class="info">
          <div>Name: <span>${name}</span></div>
          <div>Role: <span>${role}</span></div>
          <div>Mobile: <span>${mobile}</span></div>
          <div>ID: <span id="id${i}"></span></div>
        </div>
      </div>
      <div class="qr-code"><canvas id="qrCanvas${i}"></canvas></div>
    `;
          container.appendChild(cardDiv);

          // Set ID
          const idCode = "DPC" + String(currentId).padStart(4, "0");
          cardDiv.querySelector(`#id${i}`).innerText = idCode;

          // Generate QR (use canvas)
          const qrCanvas = cardDiv.querySelector(`#qrCanvas${i}`);
          const qr = new QRious({
            element: qrCanvas,
            value: `https://durgapujadharampur.vercel.app/index.html?id=${idCode}`,
            size: 80,
          });

          // Load photo
          if (photoFile) {
            const reader = new FileReader();
            reader.onload = (e) => {
              cardDiv.querySelector(`#photo${i}`).src = e.target.result;
            };
            reader.readAsDataURL(photoFile);
          }

          // Download button
          const downloadBtn = document.createElement("button");
          downloadBtn.innerText = "Download";
          downloadBtn.addEventListener("click", () => {
            html2canvas(cardDiv, { scale: 3 }).then((canvas) => {
              const link = document.createElement("a");
              link.download = `${idCode}.png`;
              link.href = canvas.toDataURL("image/png");
              link.click();
            });
          });
          container.appendChild(downloadBtn);

          currentId++;
        }
      });

      // Load html2canvas
      const script = document.createElement("script");
      script.src =
        "https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js";
      document.body.appendChild(script);
    </script>
  </body>
</html>


